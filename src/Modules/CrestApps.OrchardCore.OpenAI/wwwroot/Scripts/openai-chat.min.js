var openAIChatManager=function(){var e={messageTemplate:'\n        <div class="list-group" id="@messagesContainerHtmlId">\n                <div v-for="(message, index) in messages" :key="index" class="list-group-item">\n                    <div class="d-flex">\n                        <div class="p-2">\n                            <i :class="message.role === \'user\' ? \'fa-solid fa-user fa-2xl text-primary\' : \'fa fa-robot fa-2xl text-success\'"></i>\n                        </div>\n                        <div class="p-2 flex-grow-1" v-html="message.promptHTML || message.prompt"></div>\n                    </div>\n                </div>\n            </div>\n        ',indicatorTemplate:'<div class="spinner-grow spinner-grow-sm" role="status"><span class="visually-hidden">Loading...</span></div>'};return{initialize:function(t){var n=Object.assign({},e,t);console.log("The used config:",n),n.chatUrl?n.appElementSelector?n.chatContainerElementSelector?n.inputElementSelector?n.sendButtonElementSelector?Vue.createApp({data:function(){return{messages:[],prompt:""}},methods:{addMessage:function(e){var t=this;this.messages.push(e),this.$nextTick((function(){t.scrollToBottom()}))},handleUserInput:function(e){this.prompt=e.target.value},sendMessage:function(){var e=this,t=this.prompt.trim();if(t){var s={role:"user",prompt:t},r=document.querySelector(n.inputElementSelector),i=document.querySelector(n.sendButtonElementSelector);this.addMessage(s),this.showTypingIndicator(),r.value="",this.prompt="",i.setAttribute("disabled",!0),fetch(n.chatUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:r.getAttribute("data-session-id"),profileId:r.getAttribute("data-profile-id"),prompt:s.prompt})}).then((function(e){return e.json()})).then((function(t){e.addMessage(t.message),r.setAttribute("data-session-id",t.sessionId),e.hideTypingIndicator()})).catch((function(t){console.error("Failed to send the message.",t),e.hideTypingIndicator()}))}},showTypingIndicator:function(){this.addMessage({role:"indicator",promptHTML:n.indicatorTemplate})},hideTypingIndicator:function(){this.messages=this.messages.filter((function(e){return"indicator"!=e.role}))},scrollToBottom:function(){var e=document.querySelector(n.chatContainerElementSelector);e.scrollTop=e.scrollHeight-e.clientHeight}},mounted:function(){var e=this,t=document.querySelector(n.sendButtonElementSelector),s=document.querySelector(n.inputElementSelector),r=document.querySelector(n.placeholderElementSelector);s.addEventListener("keyup",(function(e){"Enter"===e.key&&t.dispatchEvent(new Event("click"))})),s.addEventListener("input",(function(n){n.target.value.trim()?t.removeAttribute("disabled"):t.setAttribute("disabled",!0),e.handleUserInput(n)})),t.addEventListener("click",(function(){r&&r.classList.add("d-none"),e.sendMessage()}))},template:n.messageTemplate}).mount(n.appElementSelector):console.error("The sendButtonElementSelector is required."):console.error("The inputElementSelector is required."):console.error("The chatContainerElementSelector is required."):console.error("The appElementSelector is required."):console.error("The chatUrl is required.")}}}();
