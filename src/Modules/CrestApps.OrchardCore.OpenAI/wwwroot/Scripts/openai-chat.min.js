var openAIChatManager=function(){var e={messageTemplate:'\n            <div class="list-group">\n                <div v-for="(message, index) in messages" :key="index" class="list-group-item">\n                    <div class="d-flex">\n                        <div class="p-2">\n                            <i :class="message.role === \'user\' ? \'fa-solid fa-user fa-2xl text-primary\' : \'fa fa-robot fa-2xl text-success\'"></i>\n                        </div>\n                        <div class="p-2 flex-grow-1" v-html="message.promptHTML || message.prompt"></div>\n                    </div>\n                </div>\n            </div>\n        ',indicatorTemplate:'<div class="spinner-grow spinner-grow-sm" role="status"><span class="visually-hidden">Loading...</span></div>'};return{initialize:function(t){var s=Object.assign({},e,t);s.chatUrl?s.appElementSelector?s.chatContainerElementSelector?s.inputElementSelector?s.sendButtonElementSelector?Vue.createApp({data:function(){return{isSessionStarted:!1,messages:[],prompt:""}},methods:{addMessage:function(e){var t=this;this.messages.push(e),this.$nextTick((function(){t.scrollToBottom()}))},handleUserInput:function(e){this.prompt=e.target.value},sendMessage:function(){var e=this.prompt.trim();if(e){var t={role:"user",prompt:e},n=document.querySelector(s.inputElementSelector),r=document.querySelector(s.sendButtonElementSelector);this.addMessage(t),this.showTypingIndicator(),n.value="",this.prompt="",r.setAttribute("disabled",!0),this.completeChat(n.getAttribute("data-profile-id"),t.prompt,n.getAttribute("data-session-id"))}},generatePrompt:function(e){if(e){var t=e.getAttribute("data-profile-id"),s=e.getAttribute("data-session-id");t&&s?this.completeChat(t,null,s):console.error("The given element is missing data-profile-id and/or data-session-id")}else console.error("The element paramter is required.")},completeChat:function(e,t,n){var r=this;fetch(s.chatUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileId:e,sessionId:n,prompt:t})}).then((function(e){return e.json()})).then((function(e){r.setSession(e.sessionId),r.addMessage(e.message),r.hideTypingIndicator(),r.scrollToBottom()})).catch((function(e){console.error("Failed to send the message.",e),r.hideTypingIndicator()}))},setSession:function(e){if(!this.isSessionStarted){document.querySelector(s.inputElementSelector).setAttribute("data-session-id",e);for(var t=document.getElementsByClassName("profile-generated-prompt"),n=0;n<t.length;n++)t[n].setAttribute("data-session-id",e);this.isSessionStarted=!0}},showTypingIndicator:function(){this.addMessage({role:"indicator",promptHTML:s.indicatorTemplate})},hideTypingIndicator:function(){this.messages=this.messages.filter((function(e){return"indicator"!=e.role}))},scrollToBottom:function(){var e=document.querySelector(s.chatContainerElementSelector);e.scrollTop=e.scrollHeight-e.clientHeight}},mounted:function(){var e=this,t=document.querySelector(s.sendButtonElementSelector),n=document.querySelector(s.inputElementSelector),r=document.querySelector(s.placeholderElementSelector);n.addEventListener("keyup",(function(e){"Enter"===e.key&&t.dispatchEvent(new Event("click"))})),n.addEventListener("input",(function(s){s.target.value.trim()?t.removeAttribute("disabled"):t.setAttribute("disabled",!0),e.handleUserInput(s)})),t.addEventListener("click",(function(){r&&r.classList.add("d-none"),e.sendMessage()}));for(var i=document.getElementsByClassName("profile-generated-prompt"),o=0;o<i.length;o++)i[o].addEventListener("click",(function(t){t.preventDefault(),e.generatePrompt(t)}));if(s.messages.length){for(var a=0;a<s.messages.length;a++)this.addMessage(s.messages[a]);this.scrollToBottom()}},template:s.messageTemplate}).mount(s.appElementSelector):console.error("The sendButtonElementSelector is required."):console.error("The inputElementSelector is required."):console.error("The chatContainerElementSelector is required."):console.error("The appElementSelector is required."):console.error("The chatUrl is required.")}}}();
