var openAIChatManager=function(){var e={messageTemplate:'\n            <div class="list-group">\n                <div v-for="(message, index) in messages" :key="index" class="list-group-item">\n                    <div class="d-flex">\n                        <div class="p-2">\n                            <i :class="message.role === \'user\' ? \'fa-solid fa-user fa-2xl text-primary\' : \'fa fa-robot fa-2xl text-success\'"></i>\n                        </div>\n                        <div class="p-2 flex-grow-1">\n                            <h4 v-if="message.title">{{ message.title }}</h4>\n                            <div v-html="message.contentHTML || message.content"></div>\n                        </div>\n                    </div>\n                    <div class="d-flex justify-content-center message-buttons-container">\n                        <button class="ms-2 btn btn-sm btn-outline-secondary" @click="copyResponse(message.content)" title="Click here to copy response to clipboard.">\n                            <i class="fa-solid fa-copy fa-lg"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        ',indicatorTemplate:'<div class="spinner-grow spinner-grow-sm" role="status"><span class="visually-hidden">Loading...</span></div>'};return{initialize:function(t){var n=Object.assign({},e,t);n.chatUrl?n.appElementSelector?n.chatContainerElementSelector?n.inputElementSelector?n.sendButtonElementSelector?Vue.createApp({data:function(){return{inputElement:null,buttonElement:null,chatContainer:null,placeholder:null,isSessionStarted:!1,isPlaceholderVisible:!0,messages:[],prompt:""}},methods:{addMessage:function(e){var t=this;this.messages.push(e),"indicator"!=e.role&&this.$emit("addingOpenAIPromotMessage",e),this.isPlaceholderVisible&&(this.placeholder&&this.placeholder.classList.add("d-none"),this.isPlaceholderVisible=!1),this.$nextTick((function(){t.$emit("addedOpenAIPromotMessage",e),t.scrollToBottom()}))},handleUserInput:function(e){this.prompt=e.target.value},getProfileId:function(){return this.inputElement.getAttribute("data-profile-id")},initializeElements:function(){var e=this;this.inputElement=document.querySelector(n.inputElementSelector),this.buttonElement=document.querySelector(n.sendButtonElementSelector),this.chatContainer=document.querySelector(n.chatContainerElementSelector),this.placeholder=document.querySelector(n.placeholderElementSelector),this.inputElement.addEventListener("keyup",(function(t){"Enter"===t.key&&e.buttonElement.dispatchEvent(new Event("click"))})),this.inputElement.addEventListener("input",(function(t){t.target.value.trim()?e.buttonElement.removeAttribute("disabled"):e.buttonElement.setAttribute("disabled",!0),e.handleUserInput(t)})),this.buttonElement.addEventListener("click",(function(){e.sendMessage()}))},getSessionId:function(){return this.inputElement.getAttribute("data-session-id")},copyResponse:function(e){navigator.clipboard.writeText(e)},sendMessage:function(){var e=this.prompt.trim();e&&(this.addMessage({role:"user",content:e}),this.showTypingIndicator(),this.inputElement.value="",this.prompt="",this.buttonElement.setAttribute("disabled",!0),this.completeChat(this.getProfileId(),e,this.getSessionId()))},generatePrompt:function(e){if(e){var t=e.getAttribute("data-profile-id"),n=this.getSessionId();t&&n?this.completeChat(t,null,n):console.error("The given element is missing data-profile-id or the session has not yet started.")}else console.error("The element paramter is required.")},completeChat:function(e,t,s){var i=this,o=this.getProfileId();fetch(n.chatUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileId:e,sessionId:s,prompt:t,sessionProfileId:o==e?null:o})}).then((function(e){return e.json()})).then((function(e){i.setSession(e.sessionId),i.addMessage(e.message),i.hideTypingIndicator(),i.scrollToBottom()})).catch((function(e){console.error("Failed to send the message.",e),i.hideTypingIndicator()}))},setSession:function(e){this.isSessionStarted||(this.inputElement.setAttribute("data-session-id",e),this.isSessionStarted=!0)},showTypingIndicator:function(){this.addMessage({role:"indicator",contentHTML:n.indicatorTemplate})},hideTypingIndicator:function(){this.messages=this.messages.filter((function(e){return"indicator"!=e.role}))},scrollToBottom:function(){this.chatContainer.scrollTop=this.chatContainer.scrollHeight-this.chatContainer.clientHeight}},mounted:function(){var e=this;this.initializeElements();for(var t=document.getElementsByClassName("profile-generated-prompt"),s=0;s<t.length;s++)t[s].addEventListener("click",(function(t){t.preventDefault(),e.generatePrompt(t.target)}));for(var i=0;i<n.messages.length;i++)this.addMessage(n.messages[i])},template:n.messageTemplate}).mount(n.appElementSelector):console.error("The sendButtonElementSelector is required."):console.error("The inputElementSelector is required."):console.error("The chatContainerElementSelector is required."):console.error("The appElementSelector is required."):console.error("The chatUrl is required.")}}}();
