@using CrestApps.OrchardCore.AI.ViewModels
@using OrchardCore

@model EditProfileDataSourcesViewModel

<div class="@Orchard.GetWrapperClasses()">
    <label asp-for="DataSourceId" class="@Orchard.GetLabelClasses()">@T["Data source"]</label>
    <div class="@Orchard.GetEndClasses()">
        <select asp-for="DataSourceId" asp-items="Model.DataSources" class="form-select">
            <option value="">@T["Select a data-source"]</option>
        </select>
        <span asp-validation-for="DataSourceId" class="text-danger"></span>
        <span class="hint">@T["The data-source where your data is stored."]</span>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {

        const dataSourceSelect = document.getElementById('@Html.IdFor(x => x.DataSourceId)');

        function toggleDataSourceDependentElements() {
            const dependentElements = document.querySelectorAll('.data-source-dependent');

            if (dataSourceSelect && dependentElements.length > 0) {
                const hasDataSource = dataSourceSelect.value && dataSourceSelect.value.trim() !== '';

                dependentElements.forEach(element => {
                    if (hasDataSource) {
                        element.classList.remove('d-none');
                    } else {
                        element.classList.add('d-none');
                    }
                });
            }
        }

        // Initial check on page load
        toggleDataSourceDependentElements();

        // Listen for changes on the data source select
        dataSourceSelect.addEventListener('change', toggleDataSourceDependentElements);
    });
</script>
