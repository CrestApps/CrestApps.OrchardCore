@using CrestApps.OrchardCore.AI.ViewModels
@using OrchardCore

@model EditAIDataSourceRagViewModel

<div class="@Orchard.GetWrapperClasses("data-source-dependent")">
    <label asp-for="Strictness" class="@Orchard.GetLabelClasses()">@T["Strictness"]</label>
    <div class="@Orchard.GetEndClasses()">
        <input type="number" class="form-control" asp-for="Strictness" step="1" min="1" max="5">
        <span class="hint">@T["Strictness sets the threshold to categorize documents as relevant to your queries. Raising strictness means a higher threshold for relevance and filtering out more documents that are less relevant for responses. Very high strictness could cause failure to generate responses due to limited available documents. Leave it blank to use the default of 3."]</span>
    </div>
</div>

<div class="@Orchard.GetWrapperClasses("data-source-dependent")">
    <label asp-for="TopNDocuments" class="@Orchard.GetLabelClasses()">@T["Total retrieved documents"]</label>
    <div class="@Orchard.GetEndClasses()">
        <input type="number" class="form-control" asp-for="TopNDocuments" step="1" min="3" max="20">
        <span class="hint">@T["This specifies the number of top-scoring documents from your data index used to generate responses. You want to increase the value when you have short documents or want to provide more context. Leave it blank to use the default of 3."]</span>
    </div>
</div>

<div class="@Orchard.GetWrapperClasses("data-source-dependent")">
    <label asp-for="Filter" class="@Orchard.GetLabelClasses()">@T["Filter"]</label>
    <div class="@Orchard.GetEndClasses()">
        @if (string.Equals(Model.SourceProviderName, "Elasticsearch", StringComparison.OrdinalIgnoreCase))
        {
            <textarea class="form-control" asp-for="Filter" rows="3"></textarea>
            <span class="hint">@T["Optional Elasticsearch DSL query filter in JSON format. Example: {\"term\": {\"status\": \"active\"}}"]</span>
        }
        else if (string.Equals(Model.SourceProviderName, "AzureAISearch", StringComparison.OrdinalIgnoreCase))
        {
            <input type="text" class="form-control" asp-for="Filter">
            <span class="hint">@T["Optional OData filter expression for Azure AI Search. Example: status eq 'active' and category eq 'docs'"]</span>
        }
        else
        {
            <input type="text" class="form-control" asp-for="Filter">
            <span class="hint">@T["Optional filter expression to query a subset of indexed data. The filter format depends on the search provider. Leave blank to search all data."]</span>
        }
    </div>
</div>

<div class="@Orchard.GetWrapperClasses("data-source-dependent")">
    <div class="@Orchard.GetEndClasses(true)">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" asp-for="IsInScope" />
            <label class="form-check-label" asp-for="IsInScope">
                @T["Limit responses to indexed data"]
            </label>
            <span class="hint dashed">@T["When enabled, the model will only generate responses using your data source index. If disabled, the model may use its general knowledge in addition to your data."]</span>
        </div>
    </div>
</div>
