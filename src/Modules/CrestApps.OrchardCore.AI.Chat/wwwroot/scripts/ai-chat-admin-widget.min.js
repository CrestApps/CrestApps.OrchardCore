window.aiChatAdminWidget=function(){"use strict";function t(t,e){try{var o=t.getBoundingClientRect(),n={left:o.left,top:o.top,width:t.offsetWidth,height:t.offsetHeight};localStorage.setItem(e,JSON.stringify(n))}catch(t){}}function e(t){return t.touches&&t.touches.length>0?{x:t.touches[0].clientX,y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}return{initialize:function(o){if(o&&o.containerSelector&&o.toggleSelector){var n=document.querySelector(o.containerSelector),i=document.querySelector(o.toggleSelector);if(n&&i){var a=n.querySelector(".ai-admin-widget-header"),s=n.querySelector(".ai-admin-widget-resize-handle"),r=n.querySelector(o.restoreSizeSelector),l=n.querySelector(o.promptSelector),d=o.storagePrefix||"default",c=d+"-ai-admin-widget-pos",h=d+"-ai-admin-widget-toggle-pos",u=d+"-ai-admin-widget-state",g=d+"-ai-admin-widget-session",f=d+"-ai-admin-widget-resized";!function(t,e){try{var o=localStorage.getItem(e);if(!o)return;var n=JSON.parse(o),i=window.innerWidth,a=window.innerHeight;n.left>=0&&n.top>=0&&n.left<i&&n.top<a&&(t.style.left=Math.min(n.left,i-100)+"px",t.style.top=Math.min(n.top,a-100)+"px",t.style.right="auto",t.style.bottom="auto"),n.width&&n.width>=288&&(t.style.width=Math.min(n.width,i-16)+"px"),n.height&&n.height>=320&&(t.style.height=Math.min(n.height,a-16)+"px")}catch(t){}}(n,c),function(t,e){try{var o=localStorage.getItem(e);if(!o)return;var n=JSON.parse(o),i=window.innerWidth,a=window.innerHeight;n.left>=0&&n.top>=0&&n.left<i&&n.top<a&&(t.style.left=Math.min(n.left,i-t.offsetWidth)+"px",t.style.top=Math.min(n.top,a-t.offsetHeight)+"px",t.style.right="auto",t.style.bottom="auto")}catch(t){}}(i,h),"open"===localStorage.getItem(u)&&(n.classList.add("is-open"),i.style.display="none"),i.addEventListener("click",function(t){i._wasDragged?i._wasDragged=!1:(n.classList.add("is-open"),i.style.display="none",localStorage.setItem(u,"open"))});var m=n.querySelector(o.closeButtonSelector);m&&m.addEventListener("click",function(){n.classList.remove("is-open"),i.style.display="",localStorage.setItem(u,"closed")}),a&&function(o,n,i){var a,s,r,l,d=!1;function c(t){if(!t.target.closest("button")&&!t.target.closest("a")){d=!0;var n=e(t),i=o.getBoundingClientRect();a=n.x,s=n.y,r=i.left,l=i.top,o.style.transition="none",t.preventDefault()}}function h(t){if(d){var n=e(t),i=n.x-a,c=n.y-s,h=r+i,u=l+c,g=window.innerWidth-o.offsetWidth,f=window.innerHeight-o.offsetHeight;h=Math.max(0,Math.min(h,g)),u=Math.max(0,Math.min(u,f)),o.style.left=h+"px",o.style.top=u+"px",o.style.right="auto",o.style.bottom="auto"}}function u(){d&&(d=!1,o.style.transition="",t(o,i))}n.addEventListener("mousedown",c),document.addEventListener("mousemove",h),document.addEventListener("mouseup",u),n.addEventListener("touchstart",c,{passive:!1}),document.addEventListener("touchmove",h,{passive:!1}),document.addEventListener("touchend",u)}(n,a,c),function(t,o){var n,i,a,s,r=!1,l=!1,d=5;function c(o){r=!0,l=!1,t._wasDragged=!1;var d=e(o),c=t.getBoundingClientRect();n=d.x,i=d.y,a=c.left,s=c.top,t.style.transition="none",o.preventDefault()}function h(o){if(r){var c=e(o),h=c.x-n,u=c.y-i;if(!(!l&&Math.abs(h)<d&&Math.abs(u)<d)){l=!0;var g=a+h,f=s+u,m=window.innerWidth-t.offsetWidth,y=window.innerHeight-t.offsetHeight;g=Math.max(0,Math.min(g,m)),f=Math.max(0,Math.min(f,y)),t.style.left=g+"px",t.style.top=f+"px",t.style.right="auto",t.style.bottom="auto",t.style.position="fixed"}}}function u(){r&&(r=!1,t.style.transition="",l&&(t._wasDragged=!0,function(t,e){try{var o=t.getBoundingClientRect(),n={left:o.left,top:o.top};localStorage.setItem(e,JSON.stringify(n))}catch(t){}}(t,o)))}t.addEventListener("mousedown",c),document.addEventListener("mousemove",h),document.addEventListener("mouseup",u),t.addEventListener("touchstart",c,{passive:!1}),document.addEventListener("touchmove",h,{passive:!1}),document.addEventListener("touchend",u)}(i,h),s&&function(o,n,i,a,s){var r,l,d,c,h,u,g=!1;"true"===localStorage.getItem(s)&&o.classList.add("is-resized");function f(t){g=!0;var n=e(t),i=o.getBoundingClientRect();r=n.x,l=n.y,d=o.offsetWidth,c=o.offsetHeight,h=i.left,u=i.top,o.style.transition="none",t.preventDefault(),t.stopPropagation()}function m(t){if(g){var n=e(t),i=n.x-r,a=n.y-l,s=d-i,f=c-a;s=Math.max(288,s),f=Math.max(320,f);var m=h+(d-s),y=u+(c-f);m=Math.max(0,m),y=Math.max(0,y),o.style.width=s+"px",o.style.height=f+"px",o.style.left=m+"px",o.style.top=y+"px",o.style.right="auto",o.style.bottom="auto"}}function y(){g&&(g=!1,o.style.transition="",o.classList.add("is-resized"),localStorage.setItem(s,"true"),t(o,a))}i&&i.addEventListener("click",function(){o.style.width="",o.style.height="",o.classList.remove("is-resized"),localStorage.removeItem(s),t(o,a)});n.addEventListener("mousedown",f),document.addEventListener("mousemove",m),document.addEventListener("mouseup",y),n.addEventListener("touchstart",f,{passive:!1}),document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",y)}(n,s,r,c,f),l&&function(t){var e=5*(parseFloat(getComputedStyle(t).lineHeight)||20);function o(){t.style.height="auto";var o=t.scrollHeight;t.style.height=Math.min(o,e)+"px",t.style.overflowY=o>e?"auto":"hidden"}t.addEventListener("input",o),o()}(l),o.chatConfig&&window.openAIChatManager&&(o.chatConfig.widget={showChatButton:o.toggleSelector,newChatButton:o.newChatButtonSelector,chatWidgetContainer:o.containerSelector,chatHistorySection:o.historyPanelSelector,closeHistoryButton:o.closeHistorySelector,closeChatButton:o.closeButtonSelector,showHistoryButton:o.showHistorySelector,chatWidgetStateName:g},window.openAIChatManager.initialize(o.chatConfig))}}else console.error("aiChatAdminWidget: containerSelector and toggleSelector are required.")}}}();
