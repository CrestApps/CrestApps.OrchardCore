name: "CodeQL Config for CrestApps.OrchardCore"

# This configuration file is referenced by .github/workflows/codeql.yml.
# It is NOT automatically used by GitHub's default CodeQL setup.

# Paths to ignore during analysis.
paths-ignore:
  - node_modules
  - "**/wwwroot/**"
  - "**/bin/**"
  - "**/obj/**"
  - "docs/**"
  - "BenchmarkDotNet.Artifacts/**"
  - "TestResults/**"
  # Third-party / generated files that should not be analysed.
  - "**/Assets/js/flatpickr-culture.js"

query-filters:
  # Exclude CSRF (missing antiforgery token) alerts.
  # OrchardCore framework automatically validates antiforgery tokens for all
  # POST requests via its ModularApplicationModelProvider. Every module in this
  # repository references OrchardCore.Module.Targets, which enables this global
  # validation. Adding [ValidateAntiForgeryToken] to individual actions is
  # therefore redundant.
  - exclude:
      id: cs/web/missing-token-validation
  - exclude:
      id: cs/web/missing-csrf-token-validation

  # Exclude XSS alerts for ASP.NET Core tag helper attributes.
  # All flagged views are admin-only (behind [Admin] attribute requiring
  # authentication) and use ASP.NET Core tag helper attributes like
  # asp-route-id="@ViewContext.HttpContext.Request.RouteValues["id"]". Tag
  # helpers process these values server-side and generate properly URL-encoded
  # action URLs â€” the asp-route-* attribute itself is never rendered to HTML.
  # Razor also auto-encodes @ expressions. CodeQL cannot model tag helper
  # encoding as a sanitizer, producing false positives for this standard
  # OrchardCore admin pattern.
  - exclude:
      id: cs/web/xss
